COMMENT
//ANALYTIC Robot to upload kfs vss recon test results
  IMPORT AUDIT TEST RESULTS FROM VARIOUS ODBC CONNECTORS
//RESULT LOG
END

COMMENT
INDEX
ODBC64
    Sqlite_kfs_studdeb->W:\Kfs_vss_studdeb\Kfs_vss_studdeb.sqlite
ENVIRONMENT
KFS
    STUDENT DEBTOR RECONCILIATION TESTS
        NEW ACCOUNT NOT LINKED TO CAMPUS IN PYTHON SCRIPT
        TRANSACTION TYPE DIFFER BETWEEN VSS AND GL
        TRANSACTION TYPE IN VSS NOT IN GL
        TRANSACTION TYPE IN GL NOT IN VSS (JOURNALS MOSTLY)
        BURSARY TRANSACTION TYPE DIFFER BETWEEN VSS AND GL
        BURSARY TRANSACTION TYPE IN VSS NOT IN GL
        BURSARY TRANSACTION CAMPUS DIFFER BETWEEN VSS AND GL
ENVIRONMENT RESET
END

COMMENT ENVIRONMENT
COMMENT ****************************************************************************************************

DO _Password
SET SAFETY OFF

COMMENT STUDENT DEBTOR RECONCILIATION TESTS
COMMENT ****************************************************************************************************

COMMENT NEW ACCOUNT NOT LINKED TO CAMPUS IN PYTHON SCRIPT

ACCESSDATA64 ODBC "Dsn" NAME "Sqlite_kfs_studdeb" TO "STUD_DEBT_TEST_NEW_GL_ACCOUNT.FIL" CHARMAX 100 MEMOMAX 100 
 SOURCE( )
 SQL_QUERY( SELECT * FROM X001da_test_newaccount ) END_QUERY 
OPEN STUD_DEBT_TEST_NEW_GL_ACCOUNT.FIL
COUNT
IF COUNT1 > 0 EXPORT FIELDS ALL ACLGRC PASSWORD 1 TO "81215@eu"
CLOSE PRIMARY

COMMENT TRANSACTION TYPE DIFFER BETWEEN VSS AND GL

ACCESSDATA64 ODBC "Dsn" NAME "Sqlite_kfs_studdeb" TO "STUD_DEBT_TEST_VSS_GL_DIFFERENCE.FIL" CHARMAX 100 MEMOMAX 100 
 SOURCE( )
 SQL_QUERY( SELECT * FROM X004bx_vss_gl_difference ) END_QUERY
OPEN STUD_DEBT_TEST_VSS_GL_DIFFERENCE
COUNT
IF COUNT1 > 0 EXPORT FIELDS ALL ACLGRC PASSWORD 1 TO "81202@eu"
CLOSE PRIMARY

COMMENT TRANSACTION TYPE IN VSS NOT IN GL

ACCESSDATA64 ODBC "Dsn" NAME "Sqlite_kfs_studdeb" TO "STUD_DEBT_TEST_INVSS_NOGL.FIL" CHARMAX 100 MEMOMAX 100 
 SOURCE( )
 SQL_QUERY( SELECT * FROM X004cx_invss_nogl ) END_QUERY
OPEN STUD_DEBT_TEST_INVSS_NOGL
COUNT
IF COUNT1 > 0 EXPORT FIELDS ALL ACLGRC PASSWORD 1 TO "81213@eu"
CLOSE PRIMARY

COMMENT TRANSACTION TYPE IN GL NOT IN VSS (JOURNALS MOSTLY)

ACCESSDATA64 ODBC "Dsn" NAME "Sqlite_kfs_studdeb" TO "STUD_DEBT_TEST_INGL_NOVSS.FIL" CHARMAX 100 MEMOMAX 100 
 SOURCE( )
 SQL_QUERY( SELECT * FROM X004dx_ingl_novss ) END_QUERY
OPEN STUD_DEBT_TEST_INGL_NOVSS
COUNT
IF COUNT1 > 0 EXPORT FIELDS ALL ACLGRC PASSWORD 1 TO "81214@eu"
CLOSE PRIMARY

COMMENT BURSARY TRANSACTION TYPE DIFFER BETWEEN VSS AND GL

ACCESSDATA64 ODBC "Dsn" NAME "Sqlite_kfs_studdeb" TO "STUD_DEBT_TEST_VSS_GL_DIFFERENCE_BURS.FIL" CHARMAX 100 MEMOMAX 100 
 SOURCE( )
 SQL_QUERY( SELECT * FROM X004ex_vss_gl_burs_difference ) END_QUERY
OPEN STUD_DEBT_TEST_VSS_GL_DIFFERENCE_BURS
COUNT
IF COUNT1 > 0 EXPORT FIELDS ALL ACLGRC PASSWORD 1 TO "81487@eu"
CLOSE PRIMARY

COMMENT BURSARY TRANSACTION TYPE IN VSS NOT IN GL

ACCESSDATA64 ODBC "Dsn" NAME "Sqlite_kfs_studdeb" TO "STUD_DEBT_TEST_INVSS_NOGL_BURS.FIL" CHARMAX 100 MEMOMAX 100 
 SOURCE( )
 SQL_QUERY( SELECT * FROM X010ex_bursary_invss_nogl ) END_QUERY
OPEN STUD_DEBT_TEST_INVSS_NOGL_BURS
COUNT
IF COUNT1 > 0 EXPORT FIELDS ALL ACLGRC PASSWORD 1 TO "84024@eu"
CLOSE PRIMARY

COMMENT BURSARY TRANSACTION CAMPUS DIFFER BETWEEN VSS AND GL

ACCESSDATA64 ODBC "Dsn" NAME "Sqlite_kfs_studdeb" TO "STUD_DEBT_TEST_VSS_GL_DIFFERENCE_BURS_CAMP.FIL" CHARMAX 100 MEMOMAX 100 
 SOURCE( )
 SQL_QUERY( SELECT * FROM X010fx_burs_gl_diffcampus ) END_QUERY
OPEN STUD_DEBT_TEST_VSS_GL_DIFFERENCE_BURS_CAMP
COUNT
IF COUNT1 > 0 EXPORT FIELDS ALL ACLGRC PASSWORD 1 TO "81734@eu"
CLOSE PRIMARY

COMMENT ENVIRONMENT RESET
COMMENT ****************************************************************************************************

CLOSE PRIMARY
SET SAFETY ON
